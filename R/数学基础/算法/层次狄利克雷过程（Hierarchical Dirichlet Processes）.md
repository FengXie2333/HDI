#  层次狄利克雷过程（Hierarchical Dirichlet Processes）

传统的聚类方法，如K-Means等都需要人们指定数据中类别的数量，然后模型根据一定的规则求出分组的结果。

Dirichlet过程混合模型（Dirichlet Process Mixture Model， DPMM）则是一种可以自动确定类别数量的聚类方法

层次狄利克雷过程模型是另一种分层聚类的模型，它不仅可以自动确定聚类的数量，而且是针对很多组数据建模的

大量的独立随机变量的和依分布收敛于高斯分布。

一方面，计数的独立性必然导出泊松分布；反过来，泊松分布其也蕴含了独立计数的内在性质。

一个非负“集合函数”，如果对空集取值为0，并且在“一系列集合上”具有可列可加性，那么这个“集合函数”就叫做一个“测度”(Measure)。



我们是需要解决多组数据的组内聚类问题，因此可以假设对每个小组jj都有一个与之相关的随机测度的集合Gj。而Gj是可以通过与该小组相关的一个Dirichlet过程得到，即 ![](C:\Users\feng\Desktop\QQ截图20180903154655.png)。对于不同组的数据聚类，我们可以把不同小组的DP连接起来（意思就是我们为不同的小组数据做组内聚类，而组与组之间的类别可能是相同的，在文档建模中就是每个文档都是一组数据，都有很多个主题组成，我们既要能对每个文档内的主题进行建模，同时也要保证不同文档之间的相同的主题编号代表了同一个主题，所以需要把文档之间连起来）。有个很简单的思路就能做到这些，就是把不同小组的Gj当做来自于同一个先验的结果，它们都共享一个DP先验，即 ![](C:\Users\feng\Desktop\2.png)。但是这里有个问题，当G0是一个连续分布的时候，尽管我们能通过DP的方式得到G0的离散的抽样结果，但是这些抽样的结果Gj都不具有相同的原子（atom）。也就是说，尽管组内的数据可以通过DP先验得到一系列的聚类结果，但是组与组之间的聚类标签却是不同的。所以，作者限制了这里的G0必须是离散的。最简单的做法就是把G0当做是来自于某个DP先验分布的结果。这样G0就一定是离散的了。这就是层次狄利克雷过程的基本思想的出发点。

#### 问题描述

首先，我们感兴趣的是具有多个小组的观测值数据。组内的数据与组间的数据都是可交换的。即假设我们用jj表示小组的索引，它是第jj组数据，ii是组内数据点的索引。那么，x_{j1},x_{j2},...xj1,xj2,...就是第jj组数据中的数据点。这些数据点都是可交换的。在组级别的数据中，假设x_{j}=(x_{j1},x_{j2},...)xj=(xj1,xj2,...)表示第jj个小组中的所有的数据，那么x_1,x_2,....x1,x2,....也是可交换的。

同时，每个观测点数据都是独立的从一个混合分布中抽取的，也就是说对于每个观测数据来说，都有一个与之相关的混合成分（**mixture component**）。用\theta_{ji}θji表示与观测点x_{ji}xji相关的混合成分（分布）的参数。我们把\theta_{ji}θji称为因子（factors）。注意，这些因子并不一定都是不同的。同时，我们用F(\theta_{ji})F(θji)表示给定因子\theta_{ji}θji情况下x_{ji}xji的分布



#### 中餐馆特许经营（Chinese Restaurant Franchise）

我们都知道，Dirichlet过程是关于分布的分布，从DP本身的定义中，我们是无法构造一个Dirichlet过程的。层次Dirichlet过程也是一样。这里作者引用了一个叫“中餐馆特许经营”（Chinese Restaurant Franchise，CRF）的构造过程（暂时未看到CRF的直接中国翻译，我们就以这样的名字暂定）。假设我们有个有特许经营权的中国餐馆。我们在很多地方都开了这种餐馆，并且他们都拥有相同的菜单。每个特许经验的餐馆中都有无数多的桌子，每个桌子上可以做无数多的人。第一个顾客进来之后选择了一个桌子，并点了一道菜。第二个顾客进来之后既可以选择第一个桌子，也可以选择第二个桌子，这里有一个概率。注意，每个桌子的后来者点的菜都是与坐该桌子第一个顾客点的菜一样，因此，当第二个顾客坐在第一个顾客那张桌子后，菜就不用新点了。而当用户坐在第二张桌子上之后，就要重新点个菜了。这时候，点的菜既可以是和第一张桌子一样，也可以是新的，这也是一个概率选择的问题。不同的桌子可以点到相同的菜，不同餐馆的不同桌子也可能点到相同的菜。一直下去，直到所有的用户落座就结束了。这里每个餐馆jj都相当于一组数据，每个客户都是一个数据点所属的混合分布的参数 θji，每个桌子都有个指示变量 ψjt，它对应着一道菜ϕk，这道菜就是我们之前理解的文档中的主题了，它就是来自于HH的大家共享的一个参数（注意，这里实际上ϕk是来自于H分布的一个抽样结果，也就是我们之前说的每个数据点来自的F分布的参数θ，ψjt只是一个指示变量，表明每个客户是来自哪个主题ϕ的）。因此，该过程一句话就是顾客ii走进餐馆jj，坐在了桌子tji边，而餐馆jj中的这个桌子tt对应着一道菜kjt

